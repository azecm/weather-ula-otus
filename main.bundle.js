(()=>{"use strict";const t="list",e={openWeather:"api.openweathermap.org",sypExGeo:"api.sypexgeo.net",ipApi:"ipapi.co"},n=[];async function a(){const t=await async function(){const t=await fetch(`https://${e.ipApi}/json/`);let n=(await t.json()).ip;return console.log(n),n}(),{cityName:n,ll:a}=await async function(t){const n=await fetch(`https://${e.sypExGeo}/json/${t}`),a=await n.json();console.log(a.city.lat,a.city.lon,a.city.name_ru);let o=a.city.name_ru,c=a.city.lon+","+a.city.lat;return console.log(c),{cityName:o,ll:c}}(t);o(n),c(a)}async function o(t){const n=`https://${e.openWeather}/data/2.5/weather?q=${t}&appid=6dac2d983c4b4bff9266414437d14d5e`,a=await fetch(n),o=await a.json();console.log(o.weather[0].description,o.main.temp,o.weather[0].icon);const c=`${o.main.temp}`,i=Number(c),s=Math.round(i-273.15);document.getElementById("temperature").innerText=`${s}Â°C`,document.getElementById("weatherDescription").textContent=o.weather[0].description,document.getElementById("city").innerText=`${o.name}`,document.getElementById("weatherImage").src=`https://openweathermap.org/img/wn/${o.weather[0].icon}@2x.png`}function c(t){document.getElementById("map").src=`https://static-maps.yandex.ru/v1?ll=${t}&spn=0.016457,0.00619&apikey=220bcecd-2e57-4af8-9150-e82755be7199`}async function i(t){const n=`https://${e.openWeather}/data/2.5/weather?q=${t}&appid=6dac2d983c4b4bff9266414437d14d5e`,a=await fetch(n),o=await a.json();return console.log(o.coord.lon,o.coord.lat,o.name),o.coord.lon+","+o.coord.lat}async function s(){const e=document.getElementById(t),a=document.getElementById("input"),s=a.value;a.value="",await o(s),i(s).then((t=>c(t)));const l=document.createElement("li");l.setAttribute("data-city",s),l.innerHTML=s,e.append(l),n.push(s),console.log(n),localStorage.setItem("cities",JSON.stringify(n)),e.childElementCount>10&&(e.childNodes[0].remove(),n.shift(),localStorage.setItem("cities",JSON.stringify(n)))}async function l(t){if(t.target.dataset&&t.target.dataset.city){const e=t.target.dataset.city;await o(e),i(e).then((t=>c(t)))}}window.jest||async function(){null===localStorage.getItem("cities")?a():(a(),async function(){const e=JSON.parse(localStorage.getItem("cities"));console.log(e);const a=document.getElementById(t);for(let t=0;t<e.length;t++){const o=e[t],c=document.createElement("li");c.setAttribute("data-city",o),c.innerHTML=o,a.append(c),n.push(o)}}()),document.getElementById("button").addEventListener("click",s),document.getElementById(t).addEventListener("click",l)}()})();